<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Extractor - Pixel Perfect Clone</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 256 256'%3E%3Crect width='256' height='256' rx='48' fill='%230b72ec'/%3E%3Cpath fill='white' d='M64 88h128v16H64zm0 40h96v16H64zm0 40h64v16H64z'/%3E%3C/svg%3E">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg-grad: radial-gradient(1200px 600px at 10% -10%, rgba(14,165,233,0.18), transparent 60%), radial-gradient(1000px 500px at 110% -20%, rgba(99,102,241,0.18), transparent 60%), linear-gradient(180deg, #f7fafc 0%, #f7fafc 100%); }
        body { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji"; }
        .app-bg { background-image: var(--bg-grad); }
        .glass { background: rgba(255,255,255,0.9); backdrop-filter: saturate(160%) blur(6px); }
        .loading { display: none; }
        .loading.active { display: block; }
        .progress-bar { transition: width 0.3s ease-in-out; }
        .feature-badge { background-color: #ebf8ff; color: #3182ce; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; margin-left: 6px; vertical-align: middle; }
        .chip { display:inline-flex; align-items:center; padding:6px 10px; border-radius:9999px; background:#edf2f7; color:#4a5568; font-size:12px; cursor:pointer; }
        .chip:hover { background:#e2e8f0; }
        .toggle { width: 46px; height: 26px; background: #cbd5e0; border-radius: 9999px; position: relative; transition: background .2s; }
        .toggle-knob { position:absolute; top:3px; left:3px; width:20px; height:20px; background:#fff; border-radius:9999px; transition:left .2s; box-shadow:0 1px 2px rgba(0,0,0,.12); }
        .toggle.active { background:#2563eb; }
        .toggle.active .toggle-knob { left:23px; }
        /* Dark + compact theme additions */
        .dark { color-scheme: dark; }
        .dark body, body.dark { background-color: #0b1220; }
        .dark .app-bg { background-image: radial-gradient(1200px 600px at 10% -10%, rgba(2,6,23,0.6), transparent 60%), radial-gradient(1000px 500px at 110% -20%, rgba(2,8,23,0.5), transparent 60%), linear-gradient(180deg, #0b1220 0%, #0b1220 100%); }
        .dark .glass { background: rgba(17,24,39,0.85); border-color: #1f2937 !important; }
        .dark .text-gray-800 { color: #e5e7eb !important; }
        .dark .text-gray-700 { color: #e5e7eb !important; }
        .dark .text-gray-600 { color: #cbd5e1 !important; }
        .dark .text-gray-500 { color: #94a3b8 !important; }
        .dark .bg-white { background-color: #111827 !important; color: #e5e7eb !important; }
        .dark .border-gray-100 { border-color: #1f2937 !important; }
        .dark .border-gray-200 { border-color: #334155 !important; }
        .dark .bg-blue-50 { background-color: rgba(37,99,235,0.12) !important; }
        .dark .text-blue-700 { color: #93c5fd !important; }
        .dark input, .dark textarea, .dark select { background-color: #0f172a !important; color: #e5e7eb !important; border-color: #334155 !important; }
        .compact .glass { padding: 0.9rem !important; }
        .compact header { margin-bottom: 1rem !important; }
        .compact .p-6 { padding: 1rem !important; }
        .compact .py-3 { padding-top: .55rem !important; padding-bottom: .55rem !important; }
        .compact .px-4 { padding-left: .9rem !important; padding-right: .9rem !important; }
        .compact h1 { font-size: 1.5rem !important; }
        .compact .text-lg { font-size: 1rem !important; }
        .compact .text-sm { font-size: .8rem !important; }
        .compact .chip { padding:4px 8px; font-size: 11px; }
    </style>
</head>
<body class="app-bg min-h-screen">
    <div class="px-4 py-6">
        <div class="max-w-5xl mx-auto">
            <header class="flex items-center justify-between mb-8">
                <div class="flex items-center gap-3">
                    <div class="h-10 w-10 rounded-xl bg-blue-600 flex items-center justify-center shadow-md">
                        <svg class="h-6 w-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h12M4 18h8"/></svg>
                    </div>
                    <div>
                        <h1 class="text-2xl md:text-3xl font-bold text-gray-800">Website Extractor</h1>
                        <p class="text-sm text-gray-500 -mt-1">Create pixel-perfect clones of any website</p>
                    </div>
                </div>
                <div class="flex items-center gap-3">
                    <a href="https://github.com/sirioberati/WebTwin" target="_blank" class="hidden sm:inline-flex items-center text-sm px-3 py-2 rounded-md border border-gray-200 hover:border-gray-300 text-gray-700 bg-white">GitHub</a>
                    <button id="themeToggle" class="inline-flex items-center gap-2 text-sm px-3 py-2 rounded-md border border-gray-200 hover:border-gray-300 bg-white text-gray-700" title="Toggle contrast">
                        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728 0-.707.707M6.343 17.657l-.707.707"/></svg>
                        Theme
                    </button>
                    <button id="darkToggle" class="inline-flex items-center gap-2 text-sm px-3 py-2 rounded-md border border-gray-200 hover:border-gray-300 bg-white text-gray-700" title="Toggle dark compact">
                        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
                        Dark
                    </button>
                </div>
            </header>

            <div class="grid lg:grid-cols-5 gap-6">
                <div class="lg:col-span-3">
                    <div class="glass rounded-2xl shadow-xl p-6 border border-gray-100">
                        <form id="extractForm" class="space-y-5">
                            <div>
                                <label for="url" class="block text-sm font-medium text-gray-700">Website URL</label>
                                <div class="mt-1 flex gap-2">
                                    <input type="url" id="url" name="url" required class="flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" placeholder="https://example.com">
                                </div>
                                <p class="mt-2 text-xs text-gray-500">Enter a full URL including https://</p>
                                <div class="mt-3 flex flex-wrap gap-2">
                                    <span class="chip" data-url="https://example.com">example.com</span>
                                    <span class="chip" data-url="https://news.ycombinator.com">news.ycombinator.com</span>
                                    <span class="chip" data-url="https://developer.mozilla.org">developer.mozilla.org</span>
                                    <span class="chip" data-url="https://web.dev">web.dev</span>
                                </div>
                            </div>

                            <div class="flex items-start justify-between gap-3">
                                <div class="flex items-center">
                                    <input type="checkbox" id="use_selenium" name="use_selenium" value="true" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label for="use_selenium" class="ml-2 block text-sm text-gray-900">
                                        Use advanced rendering (Selenium)
                                        <span class="feature-badge">RECOMMENDED</span>
                                        <span id="selenium-unavailable" class="hidden ml-2 text-xs text-gray-500">Unavailable on server</span>
                                    </label>
                                </div>
                                <span class="text-xs text-gray-500">Renders JavaScript and scrolls to capture dynamic content.</span>
                            </div>

                            <button type="submit" class="w-full bg-blue-600 text-white py-3 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 font-semibold">Extract Website</button>
                        </form>

                        <div id="loading" class="loading mt-6">
                            <div class="space-y-4">
                                <div class="flex items-center justify-center">
                                    <div class="animate-spin rounded-full h-8 w-8 border-2 border-blue-200 border-t-blue-600"></div>
                                </div>
                                <div class="text-center">
                                    <p class="text-gray-600 mb-2">Extracting website assets...</p>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5 overflow-hidden">
                                        <div id="progressBar" class="progress-bar bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                                    </div>
                                    <p id="progressText" class="text-sm text-gray-500 mt-2">Initializing...</p>
                                </div>
                            </div>
                        </div>

                        <div id="error" class="hidden mt-4 p-4 bg-red-50 text-red-700 rounded-md border border-red-200"></div>

                        <div id="success" class="hidden">
                            <div class="bg-green-50 border border-green-200 text-green-800 p-4 mb-4 rounded">
                                <div class="flex items-center">
                                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                                    <p class="font-semibold text-lg">Website extracted successfully!</p>
                                </div>
                                <div class="success-message mt-2">
                                    <p>Your download should start automatically. If not, click the button below:</p>
                                    <div class="mt-3 flex justify-center">
                                        <button id="direct-download" class="bg-blue-600 hover:bg-blue-700 text-white py-3 px-6 rounded-md font-bold flex items-center text-lg">
                                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
                                            Click here to download
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <aside class="lg:col-span-2 space-y-6">
                    <div class="glass rounded-2xl shadow-xl p-6 border border-gray-100">
                        <h2 class="text-lg font-semibold mb-3">Enhanced Extraction Features</h2>
                        <ul class="space-y-2 text-gray-600">
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Complete HTML DOM structure
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                All CSS stylesheets (external and inline)
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                globals.css and styling files
                                <span class="feature-badge">NEW</span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                JavaScript files and functionality
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Next.js configuration and files
                                <span class="feature-badge">NEW</span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Image configurations and assets
                                <span class="feature-badge">NEW</span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Metadata extraction
                                <span class="feature-badge">NEW</span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Mobile-specific components
                                <span class="feature-badge">NEW</span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                SVG graphics (both linked and inline)
                                <span class="feature-badge">NEW</span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Video files and player components
                                <span class="feature-badge">NEW</span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Audio files and player components
                                <span class="feature-badge">NEW</span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Font files and font family detection
                                <span class="feature-badge">NEW</span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                GIF animations and dynamic content
                                <span class="feature-badge">NEW</span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Screenshots of website and components 
                                <span class="feature-badge bg-indigo-100 text-indigo-700">PREMIUM</span>
                            </li>
                            <li class="flex items-center">
                                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                JavaScript-rendered content capture
                                <span class="feature-badge bg-indigo-100 text-indigo-700">PREMIUM</span>
                            </li>
                        </ul>
                    </div>

                    <div class="glass rounded-2xl shadow-xl p-6 border border-gray-100">
                        <h2 class="text-lg font-semibold mb-3">How to Use the Clone</h2>
                        <ol class="list-decimal pl-5 space-y-2 text-gray-600">
                            <li>Extract the downloaded ZIP file</li>
                            <li>Open the <code class="bg-gray-100 px-1 py-0.5 rounded">index.html</code> file in your browser to view the static clone</li>
                            <li>Find extracted components in the <code class="bg-gray-100 px-1 py-0.5 rounded">components</code> folder</li>
                            <li>Review metadata in <code class="bg-gray-100 px-1 py-0.5 rounded">metadata.json</code></li>
                            <li>Check <code class="bg-gray-100 px-1 py-0.5 rounded">css/globals.css</code> for global styling</li>
                            <li>Edit the HTML, CSS, and JavaScript files in Cursor to customize the design</li>
                            <li>Use the included <code class="bg-gray-100 px-1 py-0.5 rounded">manifest.json</code> file to locate specific assets</li>
                        </ol>
                        <div class="mt-4 p-4 bg-blue-50 text-blue-700 rounded-md">
                            <p class="font-medium">Pro Tip:</p>
                            <p class="text-sm mt-1">For the most accurate results, try cloning the desktop version of websites.</p>
                        </div>
                    </div>
                </aside>
            </div>

            <footer class="mt-10 py-6 text-center text-sm text-gray-500">
                <p>Built with Flask • Selenium support optional • ZIP download persists 30 minutes</p>
            </footer>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('extractForm');
            const loading = document.getElementById('loading');
            const error = document.getElementById('error');
            const success = document.getElementById('success');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            const seleniumCheckbox = document.getElementById('use_selenium');
            const seleniumUnavailable = document.getElementById('selenium-unavailable');

            // Auto-detect capabilities from server
            (function checkCapabilities(){
                try {
                    const controller = new AbortController();
                    const t = setTimeout(()=>controller.abort(), 2000);
                    fetch('/capabilities', { cache: 'no-store', signal: controller.signal })
                        .then(r => { clearTimeout(t); if (!r.ok) throw new Error('cap'); return r.json(); })
                        .then(data => {
                            if (data && data.selenium_supported === false) {
                                seleniumCheckbox.checked = false;
                                seleniumCheckbox.disabled = true;
                                seleniumCheckbox.classList.add('opacity-50','cursor-not-allowed');
                                if (seleniumUnavailable) seleniumUnavailable.classList.remove('hidden');
                            }
                        })
                        .catch(()=>{/* ignore; leave checkbox as-is */});
                } catch(e) {/* ignore */}
            })();

            // Example chips
            document.querySelectorAll('.chip[data-url]').forEach(chip => {
                chip.addEventListener('click', () => {
                    const input = document.getElementById('url');
                    input.value = chip.getAttribute('data-url');
                    input.focus();
                });
            });

            // Theme toggle (simple contrast tweak)
            const themeBtn = document.getElementById('themeToggle');
            themeBtn?.addEventListener('click', () => {
                const isAlt = document.body.classList.toggle('alt-theme');
                if (isAlt) {
                    document.documentElement.style.setProperty('--bg-grad', "radial-gradient(1200px 600px at 10% -10%, rgba(99,102,241,0.22), transparent 60%), radial-gradient(1000px 500px at 110% -20%, rgba(14,165,233,0.22), transparent 60%), linear-gradient(180deg, #eef2f7 0%, #eef2f7 100%)");
                } else {
                    document.documentElement.style.setProperty('--bg-grad', "radial-gradient(1200px 600px at 10% -10%, rgba(14,165,233,0.18), transparent 60%), radial-gradient(1000px 500px at 110% -20%, rgba(99,102,241,0.18), transparent 60%), linear-gradient(180deg, #f7fafc 0%, #f7fafc 100%)");
                }
            });

            // Dark compact toggle
            const darkBtn = document.getElementById('darkToggle');
            darkBtn?.addEventListener('click', () => {
                document.body.classList.toggle('dark');
                document.body.classList.toggle('compact');
            });

            // Progress simulation values
            let progressInterval; let currentProgress = 0;

            form.addEventListener('submit', function(e) {
                e.preventDefault();
                const url = document.getElementById('url').value.trim();
                const useSelenium = seleniumCheckbox.checked && !seleniumCheckbox.disabled;
                if (!url) { showError('Please enter a valid URL'); return; }
                resetState();
                loading.classList.add('active');
                startProgressSimulation();
                const formData = new FormData();
                formData.append('url', url);
                formData.append('use_selenium', useSelenium ? 'true' : 'false');
                if (useSelenium) progressText.textContent = 'Initializing browser for advanced rendering (this may take a minute)...';
                fetch('/extract', { method: 'POST', body: formData })
                .then(response => {
                    clearInterval(progressInterval);
                    if (response.ok) {
                        updateProgress(100, 'Download starting...');
                        setTimeout(() => { loading.classList.remove('active'); success.classList.remove('hidden'); }, 600);
                        const cd = response.headers.get('Content-Disposition');
                        let filename = 'website_clone.zip';
                        if (cd) { const m = cd.match(/filename="?([^";]+)"?/); if (m && m[1]) filename = m[1]; }
                        return response.blob().then(blob => {
                            if (blob.size < 1000) throw new Error('The server returned an empty or invalid file. Please try again.');
                            const url = window.URL.createObjectURL(blob);
                            const a = document.createElement('a'); a.style.display='none'; a.href=url; a.download=filename; document.body.appendChild(a);
                            const direct = document.getElementById('direct-download');
                            if (direct) { direct.onclick = function(){ const d=document.createElement('a'); d.href=url; d.download=filename; document.body.appendChild(d); d.click(); document.body.removeChild(d);} }
                            const successMessage = document.querySelector('.success-message');
                            if (successMessage) {
                                const fallbackDiv = document.createElement('div');
                                fallbackDiv.className = 'mt-4 p-3 bg-blue-50 rounded-md border border-blue-200 text-sm';
                                fallbackDiv.innerHTML = `
                                    <p class="font-medium text-blue-800">If the button doesn't work:</p>
                                    <a href="${url}" download="${filename}" class="inline-block mt-2 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md flex items-center text-sm">
                                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
                                        Alternative download link
                                    </a>
                                    <p class="mt-2 text-xs text-blue-600">This link will remain available for 30 minutes.</p>`;
                                const mainButtonParent = document.querySelector('.success-message .mt-3');
                                if (mainButtonParent) mainButtonParent.parentNode.appendChild(fallbackDiv);
                            }
                            setTimeout(() => { a.click(); }, 400);
                            setTimeout(() => { document.body.removeChild(a); }, 1000);
                            setTimeout(() => { window.URL.revokeObjectURL(url); }, 1800000);
                        });
                    } else {
                        return response.text().then(text => { try { const data = JSON.parse(text); throw new Error(data.error || 'Failed to extract website'); } catch { throw new Error(text || 'Failed to extract website'); } });
                    }
                })
                .catch(err => { clearInterval(progressInterval); loading.classList.remove('active'); showError(err.message || 'An error occurred while extracting the website'); });
            });

            function resetState(){ loading.classList.remove('active'); error.classList.add('hidden'); success.classList.add('hidden'); error.textContent=''; currentProgress=0; updateProgress(0,'Initializing...'); }
            function showError(message){ error.textContent = message; error.classList.remove('hidden'); }
            function startProgressSimulation(){ if (progressInterval) clearInterval(progressInterval); const useSelenium = seleniumCheckbox.checked && !seleniumCheckbox.disabled; const maxProgress = useSelenium ? 90 : 95; progressInterval = setInterval(() => { if (currentProgress < maxProgress){ if (currentProgress < 30){ currentProgress += 0.6; updateProgress(currentProgress, 'Fetching website content...'); } else if (currentProgress < 60){ currentProgress += 0.35; updateProgress(currentProgress, 'Extracting CSS and JavaScript...'); } else { currentProgress += 0.12; updateProgress(currentProgress, useSelenium ? 'Rendering JavaScript and capturing dynamic content...' : 'Downloading assets and creating ZIP file...'); } } }, 100); }
            function updateProgress(v, t){ progressBar.style.width = `${v}%`; progressText.textContent = t; }
        });
    </script>
</body>
</html>